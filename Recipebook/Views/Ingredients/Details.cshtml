@model Recipebook.Models.Ingredient
@using System.Security.Claims
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    // Page title for browser/tab
    ViewData["Title"] = "Ingredient Details";

    // Provided by controller for "created by" line
    var ownerEmail = ViewBag.OwnerEmail as string;
}

<div class="details-page position-relative">

    <div class="details-actions-top d-flex justify-content-between w-100">
        <!-- Back button returns to previous page -->
        <a onclick="history.back()" class="btn btn-brown">
            <i class="bi bi-arrow-left-circle"></i>
        </a>

        <div class="d-flex gap-2">
            @* Show Edit/Delete only to the ingredient's owner *@
            @if (User?.Identity is { IsAuthenticated: true } && Model?.OwnerId == User.FindFirstValue(ClaimTypes.NameIdentifier))
            {
                <a asp-action="Edit" asp-route-id="@Model?.Id" class="btn btn-primary">
                    <i class="bi bi-pencil-square"></i>
                </a>
                <a asp-action="Delete" asp-route-id="@Model?.Id" class="btn btn-danger">
                    <i class="bi bi-trash"></i>
                </a>
            }
        </div>
    </div>

    <div class="details-header text-center mt-5">
        <h1 class="recipe-title">@Model?.Name</h1>

        @* Show who created the ingredient if email is available *@
        @if (!string.IsNullOrEmpty(ownerEmail))
        {
            <div class="author d-flex justify-content-center align-items-center gap-2">
                <span>
                    Ingredient created by <a href="mailto:@ownerEmail">@ownerEmail</a>
                </span>
            </div>
        }
    </div>

    <div class="details-body mt-4">
        <h4 class="section-title mt-4">Ingredient Details</h4>

        <!-- Simple key/value layout for ingredient info -->
        <dl class="row">
            <dt class="col-sm-2">Name</dt>
            <dd class="col-sm-10">@Model?.Name</dd>
        </dl>
    </div>
</div>
